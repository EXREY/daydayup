# Skynet 学习日志 - qhl
- 从2016-01-06附近的版本开始研究，基本就是v1.0.0-rc这个tag  
- 摘记及个人理解  
- 如有明确错误，直接修改提交  
- 如有疑问或不确定的需要讨论，请开[issue](https://github.com/doubility-sky/daydayup/issues/new) @相关人员（如：HanleiQin/ice）或team全体人员 来讨论交流。

**以上两条考虑作为公共准则，提示在首页，标记在脚注里。**


# 理念
- 单进程多线程  
- 核心功能：服务    
- 主张所有的服务都在同一个 OS 进程中协作完成
- 核心层内，不考虑跨机通讯的机制
- 不为单独一个服务的崩溃，重启等提供相应的支持 （**任其崩溃哲学**）

# 服务 
#### 定义
- 把一个符合规范的 C 模块，从动态库（so 文件）中启动起来，这个模块被称为服务（Service）。
- 每个服务都是被一个个消息包驱动，当没有包到来的时候，它们就会处于挂起状态，对 CPU 资源零消耗。

#### 属性
- 绑定有一个永不重复（即使模块退出）的数字 id 做为其 handle
- handle 的最终限制在 24bit 内，也就是 16M 个。  
- handle 高8位，保留给集群间通讯用的。

#### 行为
- 可以向 Skynet 框架注册一个 callback 函数，用来接收发给它的消息。
- 服务间可以自由发送消息 

#### 扩展 
- 如需自主逻辑，可用 Skynet 系统提供的 timeout 消息，定期触发。

# 集群  
- 每个 skynet 节点有不同的 id 。  
- 允许 255 个 skynet 节点部署在不同的机器上协作
- 通讯由一个独立的 harbor 服务来完成  
- harbor id 用 handle 高8位来标记
- 每个消息包产生的时候，skynet 框架会把自己的 harbor id 编码到源地址（handle）的高 8 位



